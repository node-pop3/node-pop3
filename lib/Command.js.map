{"version":3,"file":"Command.js","names":["value","then","direct","Promise","resolve","Pop3Command","user","password","host","port","tls","timeout","tlsOptions","servername","_PASSInfo","_socket","info","msgNumber","_connect","stream","stream2String","str","list","listify","n","Pop3Connection"],"sources":["../src/Command.mjs"],"sourcesContent":["import Pop3Connection from './Connection.mjs';\r\n\r\nimport { stream2String, listify } from './helper.mjs';\r\n\r\nclass Pop3Command extends Pop3Connection {\r\n  constructor({\r\n    user,\r\n    password,\r\n    host,\r\n    port,\r\n    tls,\r\n    timeout,\r\n    tlsOptions,\r\n    servername\r\n  }) {\r\n    super({ host, port, tls, timeout, tlsOptions, servername });\r\n    this.user = user;\r\n    this.password = password;\r\n    this._PASSInfo = '';\r\n  }\r\n\r\n  async _connect() {\r\n    if (this._socket) {\r\n      return this._PASSInfo;\r\n    }\r\n    await super.connect();\r\n    await super.command('USER', this.user);\r\n    const [info] = await super.command('PASS', this.password);\r\n    this._PASSInfo = info;\r\n    return this._PASSInfo;\r\n  }\r\n\r\n  async UIDL(msgNumber = '') {\r\n    await this._connect();\r\n    const [, stream] = await super.command('UIDL', msgNumber);\r\n    const str = await stream2String(stream);\r\n    const list = listify(str);\r\n    return msgNumber ? list[0] : list;\r\n  }\r\n\r\n  async NOOP() {\r\n    await this._connect();\r\n    await super.command('NOOP');\r\n    return;\r\n  }\r\n\r\n  async LIST(msgNumber = '') {\r\n    await this._connect();\r\n    const [, stream] = await super.command('LIST', msgNumber);\r\n    const str = await stream2String(stream);\r\n    const list = listify(str);\r\n    return msgNumber ? list[0] : list;\r\n  }\r\n\r\n  async RSET() {\r\n    await this._connect();\r\n    const [info] = await super.command('RSET');\r\n    return info;\r\n  }\r\n\r\n  async RETR(msgNumber) {\r\n    await this._connect();\r\n    const [, stream] = await super.command('RETR', msgNumber);\r\n    return stream2String(stream);\r\n  }\r\n\r\n  async DELE(msgNumber) {\r\n    await this._connect();\r\n    const [info] = await super.command('DELE', msgNumber);\r\n    return info;\r\n  }\r\n\r\n  async STAT() {\r\n    await this._connect();\r\n    const [info] = await super.command('STAT');\r\n    return info;\r\n  }\r\n\r\n  async TOP(msgNumber, n = 0) {\r\n    await this._connect();\r\n    const [, stream] = await super.command('TOP', msgNumber, n);\r\n    return stream2String(stream);\r\n  }\r\n\r\n  async QUIT() {\r\n    if (!this._socket) {\r\n      this._PASSInfo = '' || 'Bye';\r\n      return this._PASSInfo;\r\n    }\r\n    const [info] = await super.command('QUIT');\r\n    this._PASSInfo = info || '';\r\n    return this._PASSInfo;\r\n  }\r\n}\r\n\r\nPop3Command.stream2String = stream2String;\r\nPop3Command.listify = listify;\r\n\r\nexport default Pop3Command;\r\n"],"mappings":"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"}