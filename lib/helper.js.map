{"version":3,"file":"helper.js","names":["_constant","require","stream2String","stream","maxMailSize","Promise","resolve","reject","buffer","Buffer","concat","_buffer2","length","on","_buffer","err","Error","eventName","destroy","toString","listify","str","split","CRLF","filter","line","map"],"sources":["../src/helper.mjs"],"sourcesContent":["import { CRLF } from './constant.mjs';\n\nexport function stream2String(stream, maxMailSize) {\n  return new Promise((resolve, reject) => {\n    let buffer = Buffer.concat([]);\n    let {length} = buffer;\n    stream.on('data', (_buffer) => {\n      length += _buffer.length;\n      if (length >= maxMailSize) {\n        const err = new Error('mailSizeExceeded');\n        err.eventName = 'max-mail-size-exceeded';\n        stream.destroy(err)\n      }\n      else buffer = Buffer.concat([buffer, _buffer], length);\n    });\n    stream.on('error', (err) => reject(err));\n    stream.on('end', () => resolve(buffer.toString()));\n  });\n}\n\nexport function listify(str) {\n  return str.split(CRLF)\n    .filter((line) => line)\n    .map((line) => line.split(' '));\n}\n"],"mappings":";;;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AAEO,SAASC,aAAaA,CAACC,MAAM,EAAEC,WAAW,EAAE;EACjD,OAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;IACtC,IAAIC,MAAM,GAAGC,MAAM,CAACC,MAAM,CAAC,EAAE,CAAC;IAC9B,IAAAC,QAAA,GAAeH,MAAM;MAAhBI,MAAM,GAAAD,QAAA,CAANC,MAAM;IACXT,MAAM,CAACU,EAAE,CAAC,MAAM,EAAE,UAACC,OAAO,EAAK;MAC7BF,MAAM,IAAIE,OAAO,CAACF,MAAM;MACxB,IAAIA,MAAM,IAAIR,WAAW,EAAE;QACzB,IAAMW,GAAG,GAAG,IAAIC,KAAK,CAAC,kBAAkB,CAAC;QACzCD,GAAG,CAACE,SAAS,GAAG,wBAAwB;QACxCd,MAAM,CAACe,OAAO,CAACH,GAAG,CAAC;MACrB,CAAC,MACIP,MAAM,GAAGC,MAAM,CAACC,MAAM,CAAC,CAACF,MAAM,EAAEM,OAAO,CAAC,EAAEF,MAAM,CAAC;IACxD,CAAC,CAAC;IACFT,MAAM,CAACU,EAAE,CAAC,OAAO,EAAE,UAACE,GAAG;MAAA,OAAKR,MAAM,CAACQ,GAAG,CAAC;IAAA,EAAC;IACxCZ,MAAM,CAACU,EAAE,CAAC,KAAK,EAAE;MAAA,OAAMP,OAAO,CAACE,MAAM,CAACW,QAAQ,EAAE,CAAC;IAAA,EAAC;EACpD,CAAC,CAAC;AACJ;AAEO,SAASC,OAAOA,CAACC,GAAG,EAAE;EAC3B,OAAOA,GAAG,CAACC,KAAK,CAACC,cAAI,CAAC,CACnBC,MAAM,CAAC,UAACC,IAAI;IAAA,OAAKA,IAAI;EAAA,EAAC,CACtBC,GAAG,CAAC,UAACD,IAAI;IAAA,OAAKA,IAAI,CAACH,KAAK,CAAC,GAAG,CAAC;EAAA,EAAC;AACnC"}