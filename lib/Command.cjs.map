{"version":3,"file":"Command.cjs","names":["Pop3Command","Pop3Connection","constructor","user","password","host","port","tls","timeout","tlsOptions","servername","_PASSInfo","_connect","_socket","connect","command","info","UIDL","msgNumber","stream","str","stream2String","list","listify","NOOP","LIST","RSET","RETR","DELE","STAT","TOP","n","QUIT"],"sources":["../src/Command.js"],"sourcesContent":["import Pop3Connection from './Connection.js';\n\nimport { stream2String, listify } from './helper.js';\n\nclass Pop3Command extends Pop3Connection {\n  constructor({\n    user,\n    password,\n    host,\n    port,\n    tls,\n    timeout,\n    tlsOptions,\n    servername\n  }) {\n    super({ host, port, tls, timeout, tlsOptions, servername });\n    this.user = user;\n    this.password = password;\n    this._PASSInfo = '';\n  }\n\n  async _connect() {\n    if (this._socket) {\n      return this._PASSInfo;\n    }\n    await super.connect();\n    await super.command('USER', this.user);\n    const [info] = await super.command('PASS', this.password);\n    this._PASSInfo = info;\n    return this._PASSInfo;\n  }\n\n  async UIDL(msgNumber = '') {\n    await this._connect();\n    const [, stream] = await super.command('UIDL', msgNumber);\n    const str = await stream2String(stream);\n    const list = listify(str);\n    return msgNumber ? list[0] : list;\n  }\n\n  async NOOP() {\n    await this._connect();\n    await super.command('NOOP');\n    return;\n  }\n\n  async LIST(msgNumber = '') {\n    await this._connect();\n    const [, stream] = await super.command('LIST', msgNumber);\n    const str = await stream2String(stream);\n    const list = listify(str);\n    return msgNumber ? list[0] : list;\n  }\n\n  async RSET() {\n    await this._connect();\n    const [info] = await super.command('RSET');\n    return info;\n  }\n\n  async RETR(msgNumber) {\n    await this._connect();\n    const [, stream] = await super.command('RETR', msgNumber);\n    return stream2String(stream);\n  }\n\n  async DELE(msgNumber) {\n    await this._connect();\n    const [info] = await super.command('DELE', msgNumber);\n    return info;\n  }\n\n  async STAT() {\n    await this._connect();\n    const [info] = await super.command('STAT');\n    return info;\n  }\n\n  async TOP(msgNumber, n = 0) {\n    await this._connect();\n    const [, stream] = await super.command('TOP', msgNumber, n);\n    return stream2String(stream);\n  }\n\n  async QUIT() {\n    if (!this._socket) {\n      this._PASSInfo = '' || 'Bye';\n      return this._PASSInfo;\n    }\n    const [info] = await super.command('QUIT');\n    this._PASSInfo = info || '';\n    return this._PASSInfo;\n  }\n}\n\nPop3Command.stream2String = stream2String;\nPop3Command.listify = listify;\n\nexport default Pop3Command;\n"],"mappings":"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"}